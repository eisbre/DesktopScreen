## 项目介绍

本项目使用的主控芯片为ESP32-WROOM-32E

项目主体来源于[桌面屏幕]([[有手就行系列]嵌入式单片机教程-桌面小屏幕实战教学 从设计、硬件、焊接到代码编写、调试 ESP32 持续更新2022_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1wV4y1G7Vk/?spm_id_from=333.999.0.0&vd_source=fb56c33ea534d862b2270f74afe8a791))

针对项目做了以下修改：

* 硬件上因为不想使用蜂鸣器，所以没有贴蜂鸣器模块，代码中也将PWM驱动蜂鸣器的部分屏蔽。
* 因为取消了温湿度传感器，所以时钟界面的温湿度无法正常获取，所以将其删除，修改为显示日期，星期。
* 原项目中的城市只有三个选项，这里修改为输入城市拼音（具体参照心知天气的城市列表），用于获取天气信息。
* 因为b站API变化，必须使用HTTPS，所以原有接口弃用，这里将粉丝获取界面相关代码删除，保留HTTPS模板。
* 修改单词界面的换页方式，改为上划换单词。
* 修改配置界面的信息。
* 增加了新页面，可显示200*200图片。
* 增加数据重置功能，在主页上划，然后复位单片机，就可以开启AP模式，此时用手机接入，就可以在浏览器中配置WIFI，番茄钟，城市信息。

计划增加的功能

* 单词界面的数据较少，结合以前使用云服务器的经验，计划在云服务器上使用Django搭建后端，用于向小屏幕提供单词信息，小屏幕联网接收并展示单词信息。
* 计划增加第二页，添加设置，图库等功能。

## 硬件资源

### 概览

- 搭载Xtensa® 双核 32位 LX6 微处理器，支持高达 240 MHz 的时钟频率。
- 片内 448 KB ROM + 520 KB SRAM + 16 KB RTC SRAM。
- 集成 802.11b/g/n，802.11n 数据速率高达 150 Mbps，支持蓝牙 V4.2 BR/EDR 和蓝牙 LE 标准。
- +19.5 dBm 天线端输出功率，确保良好的覆盖范围
- 外设包括电容式触摸传感器，霍尔传感器，SD 卡接口，以太网，高速 SPI，UART，I2S 和 I2C，CAN，ADC，DAC，PWM，IR。

### 引脚定义

![](https://picbed-1312285733.cos.ap-beijing.myqcloud.com/img/202309142032413.webp)

ESP32 共有 6 个 Strapping 引脚。
• GPIO0：内部上拉，**Flash 烧录时要拉低电平**
• GPIO2：内部下拉
• GPIO4：内部下拉
• GPIO5：内部上拉(启动必须为高)
• GPIO12：内部下拉(启动必须为低)
• GPIO15：内部上拉(启动必须为高)

数字通用IO引脚

| GPIO | 输入 | 输出 | 备注                                            |
| ---- | ---- | ---- | ----------------------------------------------- |
| 0    | OK   | OK   | 内部上拉，启动时输出PWM信号 ，FLASH烧录控制引脚 |
| 1    | OK   | OK   | UART0 TXD 串口输出                              |
| 2    | OK   | OK   | 内部下拉                                        |
| 3    | OK   | OK   | UART0 RXD 串口输入，且启动时为高电平            |
| 4    | OK   | OK   | 内部下拉                                        |
| 5    | OK   | OK   | 内部上拉，启动时输出PWM信号                     |
| 12   | OK   | OK   | MTDI 可用于JTAG调试、内部下拉                   |
| 13   | OK   | OK   | MTCK 可用于JTAG调试                             |
| 14   | OK   | OK   | MTMS 可用于JTAG调试，启动时输出PWM信号          |
| 15   | OK   | OK   | MTDO 可用于JTAG调试、内部上拉                   |
| 16   | OK   | OK   | UART2_RXD                                       |
| 17   | OK   | OK   | UART2_TXD                                       |
| 18   | OK   | OK   |                                                 |
| 19   | OK   | OK   |                                                 |
| 20   | OK   | OK   |                                                 |
| 21   | OK   | OK   | IIC_SDA                                         |
| 22   | OK   | OK   | IIC_SCL                                         |
| 23   | OK   | OK   |                                                 |
| 24   | OK   | OK   |                                                 |
| 25   | OK   | OK   |                                                 |
| 26   | OK   | OK   |                                                 |
| 27   | OK   | OK   |                                                 |
| 28   | OK   | OK   |                                                 |
| 29   | OK   | OK   |                                                 |
| 30   | OK   | OK   |                                                 |
| 31   | OK   | OK   |                                                 |
| 32   | OK   | OK   | 32K_XP                                          |
| 33   | OK   | OK   | 32K_XN                                          |

**GPIO 6-GPIO 11连接到ESP32模块上的集成SPI闪存，不建议用于其他用途**

| GPIO | 输入 | 输出 | 备注                     |
| ---- | ---- | ---- | ------------------------ |
| 6    | OK   | OK   | SD_CLK                   |
| 7    | OK   | OK   | SD_DATA_0                |
| 8    | OK   | OK   | SD_DATA_1                |
| 9    | OK   | OK   | SD_DATA_2、**UART1_RXD** |
| 10   | OK   | OK   | SD_DATA_3、**UART1_TXD** |
| 11   | OK   | OK   | SD_CMD                   |

可以直接调用官方的API来操作片上闪存。

仅输入引脚

GPIO 34-39是GPIO仅输入引脚。这些引脚没有内部上拉或下拉电阻。它们不能用作输出，因此只能将这些引脚用作输入，常用于ADC输入通道。

### 时钟

时钟树

![](https://picbed-1312285733.cos.ap-beijing.myqcloud.com/img/202309142127308.webp)

这里使用内部时钟。

### 原理图

![](https://picbed-1312285733.cos.ap-beijing.myqcloud.com/img/202309142032992.webp)

使用的大部分硬件资源已经集成在芯片内部，外接主要是屏幕和触摸模块。屏幕使用SPI协议；触摸模块的T_INT引脚用于向主控发送中断请求，用于在中断中处理触模位置信息，位置信息的数据使用I2C协议；USB转串口使用CH340，接入串口0；蜂鸣器接入普通GPIO即可，可用于调试，实际项目中并未使用。

